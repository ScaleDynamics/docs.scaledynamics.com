"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1265],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=s(a),m=o,h=u["".concat(p,".").concat(m)]||u[m]||d[m]||r;return a?n.createElement(h,l(l({ref:t},c),{},{components:a})):n.createElement(h,l({ref:t},c))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[u]="string"==typeof e?e:o,l[1]=i;for(var s=2;s<r;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},8276:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var n=a(7462),o=(a(7294),a(3905));const r={slug:"drupal-on-docker",title:"How to deploy Drupal on cloud with Docker",authors:["nico"],tags:["Drupal","Docker","cloud","ScaleDynamics","deploy"]},l=void 0,i={permalink:"/blog/drupal-on-docker",source:"@site/blog/2022-03-09-drupal-on-docker/index.md",title:"How to deploy Drupal on cloud with Docker",description:"Drupal is an open source content management platform powering millions of websites and applications.",date:"2022-03-09T00:00:00.000Z",formattedDate:"March 9, 2022",tags:[{label:"Drupal",permalink:"/blog/tags/drupal"},{label:"Docker",permalink:"/blog/tags/docker"},{label:"cloud",permalink:"/blog/tags/cloud"},{label:"ScaleDynamics",permalink:"/blog/tags/scale-dynamics"},{label:"deploy",permalink:"/blog/tags/deploy"}],readingTime:6.065,hasTruncateMarker:!0,authors:[{name:"Nicolas Pennec",title:"Full Stack Engineer @ ScaleDynamics",key:"nico"}],frontMatter:{slug:"drupal-on-docker",title:"How to deploy Drupal on cloud with Docker",authors:["nico"],tags:["Drupal","Docker","cloud","ScaleDynamics","deploy"]},prevItem:{title:"Deploy a Spring Boot Kotlin application with Docker",permalink:"/blog/spring-kotlin-petclinic"},nextItem:{title:"CI/CD with a simple NestJS server",permalink:"/blog/nest-github-actions"}},p={authorsImageUrls:[void 0]},s=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Init your Drupal application",id:"init-your-drupal-application",level:2},{value:"Configure your cloud deployment",id:"configure-your-cloud-deployment",level:2},{value:"Account creation and resource selection",id:"account-creation-and-resource-selection",level:3},{value:"Configuration file",id:"configuration-file",level:3},{value:"Deploy your Drupal container",id:"deploy-your-drupal-container",level:2},{value:"Install SDK",id:"install-sdk",level:3},{value:"Login to ScaleDynamics",id:"login-to-scaledynamics",level:3},{value:"Run deployment",id:"run-deployment",level:3},{value:"Setup your Drupal website",id:"setup-your-drupal-website",level:2},{value:"Go further with dedicated resources",id:"go-further-with-dedicated-resources",level:2},{value:"What\u2019s next",id:"whats-next",level:2}],c={toc:s},u="wrapper";function d(e){let{components:t,...r}=e;return(0,o.kt)(u,(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Drupal is an open source content management platform powering millions of websites and applications.\nWe will see how you can easily deploy a simple Drupal website on Docker to the cloud with ScaleDynamics."),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.drupal.org/"},"Drupal")," is one of the most popular CMS (Content Management Software).\nBuild with ",(0,o.kt)("a",{parentName:"p",href:"https://www.php.net/"},"PHP"),", It is a versatile open source platform for building amazing digital experiences.\nDrupal is used to make many of the websites and applications you use every day, see the ",(0,o.kt)("a",{parentName:"p",href:"https://www.drupal.com/showcases"},"official showcases"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Drupal logo",src:a(2612).Z,width:"335",height:"84"})),(0,o.kt)("p",null,"Drupal has great standard features, like easy content authoring, reliable performance, and excellent security.\nBut what sets it apart is its flexibility; modularity is one of its core principles."),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"To follow this tutorial, we will need:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Node.js <= 12, we recommend to install the ",(0,o.kt)("a",{parentName:"li",href:"https://nodejs.org/en/download/"},"latest LTS version")),(0,o.kt)("li",{parentName:"ul"},"Basic knowledge of ",(0,o.kt)("a",{parentName:"li",href:"https://www.docker.com/"},"Docker"),", and more specifically about ",(0,o.kt)("a",{parentName:"li",href:"https://docs.docker.com/engine/reference/builder/"},"Dockerfile"))),(0,o.kt)("h2",{id:"init-your-drupal-application"},"Init your Drupal application"),(0,o.kt)("p",null,"From your terminal, start by creating a new folder named ",(0,o.kt)("inlineCode",{parentName:"p"},"drupal-app")," and change directory into it:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"mkdir drupal-app\ncd drupal-app\n")),(0,o.kt)("p",null,"Then create a new file named ",(0,o.kt)("inlineCode",{parentName:"p"},"Dockerfile")," and paste the following code into it, in order to build you container from an ",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/_/drupal"},"official image of Drupal")," downloaded from ",(0,o.kt)("a",{parentName:"p",href:"https://hub.docker.com/"},"Docker Hub"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dockerfile",metastring:'title="drupal-app/Dockerfile"',title:'"drupal-app/Dockerfile"'},"FROM drupal:latest\nEXPOSE 80\n")),(0,o.kt)("p",null,"In this configuration, we have chosen the official Drupal image with the ",(0,o.kt)("inlineCode",{parentName:"p"},"latest")," tag. For a production use case, we recommend setting a stable version with a specified number, like ",(0,o.kt)("inlineCode",{parentName:"p"},"drupal:9.3")," for example."),(0,o.kt)("h2",{id:"configure-your-cloud-deployment"},"Configure your cloud deployment"),(0,o.kt)("p",null,"The application is ready, now let's look at the deployment part."),(0,o.kt)("h3",{id:"account-creation-and-resource-selection"},"Account creation and resource selection"),(0,o.kt)("p",null,"To deploy this application on ScaleDynamics's cloud, you need an account and create an environment with a resource for it. The cloud resource provides virtual CPU and storage capacities used to execute the app. In this tutorial we will use a free shared resource available on ScaleDynamics\u2019s cloud. These are the best one for testing. In this tutorial we will see later how you can upgrade to a dedicated production resource on the public cloud provider and region of your choice."),(0,o.kt)("p",null,"If you don't have an account, feel free to create one ",(0,o.kt)("a",{parentName:"p",href:"https://console.scaledynamics.com/auth/signup/"},"here")," (it's free and no credit card are required). Once your account is created, sign in."),(0,o.kt)("p",null,"Let's create a project and an environment on the ScaleDynamics's ",(0,o.kt)("a",{parentName:"p",href:"https://console.scaledynamics.com"},"Console"),". Select your organization, create a new project, then create a new environment. Now you need to choose what kind of service is required for your deployment. There are four types:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Managed HTTP Docker"),(0,o.kt)("li",{parentName:"ul"},"Managed Node.js server"),(0,o.kt)("li",{parentName:"ul"},"Managed Node.js module"),(0,o.kt)("li",{parentName:"ul"},"Static assets hosting")),(0,o.kt)("p",null,"For this Drupal project, we need a Docker container to run the PHP server. Let's pick the ",(0,o.kt)("strong",{parentName:"p"},"managed HTTP Docker"),". You can learn more on the other types in the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.scaledynamics.com/"},"ScaleDynamics documentation"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Environment creation",src:a(3172).Z,width:"2610",height:"1504"})),(0,o.kt)("h3",{id:"configuration-file"},"Configuration file"),(0,o.kt)("p",null,"Now let's add a configuration to tell the SDK what type of application we want to deploy.",(0,o.kt)("br",{parentName:"p"}),"\n","At the root of the project, create a new file named ",(0,o.kt)("inlineCode",{parentName:"p"},"warp.config.js")," with the following content:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="drupal-app/warp.config.js"',title:'"drupal-app/warp.config.js"'},'module.exports = {\n  docker: "drupal-app",\n};\n')),(0,o.kt)("h2",{id:"deploy-your-drupal-container"},"Deploy your Drupal container"),(0,o.kt)("p",null,"Next to deploy your container on the ScaleDynamics platform, you have to use the CLI from SDK."),(0,o.kt)("h3",{id:"install-sdk"},"Install SDK"),(0,o.kt)("p",null,"First, install once our public SDK called ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/warp"},(0,o.kt)("inlineCode",{parentName:"a"},"warp"))," and available on the official npm registry: ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/warp"},"https://www.npmjs.com/package/warp")),(0,o.kt)("p",null,"Install the library as development dependency in your project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npm init -y\nnpm install --save-dev warp\n")),(0,o.kt)("p",null,"Or, install it as an npm global dependency on your system:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npm install -g warp\n")),(0,o.kt)("p",null,"For the next steps, we will use the ",(0,o.kt)("inlineCode",{parentName:"p"},"npx")," command to run each ",(0,o.kt)("inlineCode",{parentName:"p"},"warp")," command.",(0,o.kt)("br",{parentName:"p"}),"\n","The ",(0,o.kt)("inlineCode",{parentName:"p"},"npx")," command allows you to run an arbitrary command from an npm package (either one installed locally, or fetched remotely), in a similar context as running it via ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run"),"."),(0,o.kt)("p",null,"If you need help on the ",(0,o.kt)("inlineCode",{parentName:"p"},"warp")," CLI, just run the help command as below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npx warp --help\n")),(0,o.kt)("p",null,"See more about ",(0,o.kt)("a",{parentName:"p",href:"https://docs.scaledynamics.com/docs/caas/caas_sdk"},"SDK installation")," and its use in the ScaleDynamics documentation."),(0,o.kt)("h3",{id:"login-to-scaledynamics"},"Login to ScaleDynamics"),(0,o.kt)("p",null,"For the first time, you must login to the ScaleDynamics platform. So run once the ",(0,o.kt)("inlineCode",{parentName:"p"},"warp login")," command to enter your account credentials:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npx warp login\n")),(0,o.kt)("p",null,"Note that the prompt will ask you to select an organization, only if you have more than one!"),(0,o.kt)("h3",{id:"run-deployment"},"Run deployment"),(0,o.kt)("p",null,"Now it's time to deploy your awesome Drupal project on your managed cloud resource."),(0,o.kt)("p",null,"To achieve that step, you just need to run the ",(0,o.kt)("inlineCode",{parentName:"p"},"warp deploy")," simple command line:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npx warp deploy\n")),(0,o.kt)("p",null,"The deploy command will detect that your application needs to be deployed as Docker resource. The interactive mode will ask you to pick a project and an environnement, in order to deploy your Drupal container on cloud. Then you will have to choose a domain name as public URL. Leave blank if you want a generate random one."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"npx deploy",src:a(5327).Z,width:"1440",height:"644"})),(0,o.kt)("p",null,"Your Drupal container is now deployed and ready to use from the returned public URL! On the next step, you will have to configure your Drupal website."),(0,o.kt)("p",null,"In addition, you can automate your deployment and avoid interactive mode with the following options. It can be useful to run that operation from your ",(0,o.kt)("a",{parentName:"p",href:"https://docs.scaledynamics.com/docs/containers/cicd"},"CI/CD pipeline")," by example."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npx warp deploy --project <project-name> --env <env-name>\n")),(0,o.kt)("p",null,"See more about ",(0,o.kt)("inlineCode",{parentName:"p"},"warp deploy")," command in the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.scaledynamics.com/docs/sdk/cli#deploy"},"SDK documentation")),(0,o.kt)("h2",{id:"setup-your-drupal-website"},"Setup your Drupal website"),(0,o.kt)("p",null,'Open your browser, go the URL of your managed Docker resource that now serves your Drupal container and start the setup "set-by-step" of your website.'),(0,o.kt)("p",null,"The first load will show you the Drupal interactive initial setup. First, pick your language on form and continue."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"drupal setup step 1",src:a(4244).Z,width:"1568",height:"740"})),(0,o.kt)("p",null,'Then select the "',(0,o.kt)("strong",{parentName:"p"},"Demo: Umami Food Magazine"),'" as current installation profile. This option will generate a ready-to-use website sample built from the Drupal CMS that show off some of its most common capabilities. If you are already familiar with the Drupal platform, choose a "Standard" or "Minimal" profile according to your needs.'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"drupal setup step 2",src:a(9218).Z,width:"1564",height:"882"})),(0,o.kt)("p",null,'Next step, select the "',(0,o.kt)("strong",{parentName:"p"},"SQLite"),'" database for this sample and set your admin password. For production usage, we recommend using an external database, like MySQL or PostgreSQL. You can easily find a DBaaS (Database-as-a-Service) provider to host your data.'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"drupal setup step 3",src:a(6929).Z,width:"1564",height:"1054"})),(0,o.kt)("p",null,"Finally step, just wait for the complete installation..."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"drupal setup step 4",src:a(6674).Z,width:"1564",height:"742"})),(0,o.kt)("p",null,"Well done! Your new Drupal website is now live on the cloud provider of your choice."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"drupal website homepage",src:a(454).Z,width:"2020",height:"1390"})),(0,o.kt)("p",null,'You can go in the "',(0,o.kt)("strong",{parentName:"p"},"Log in"),'" section of your published website, enter your admin credentials and try the awesome features offered by the Drupal platform \ud83d\ude80'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"drupal website homepage",src:a(5681).Z,width:"2020",height:"1298"})),(0,o.kt)("p",null,"Note that you can easily import, export, and synchronize your Drupal configuration from the administration page. See details on the ",(0,o.kt)("a",{parentName:"p",href:"https://www.drupal.org/docs/configuration-management/managing-your-sites-configuration"},"Drupal documentation"),"."),(0,o.kt)("h2",{id:"go-further-with-dedicated-resources"},"Go further with dedicated resources"),(0,o.kt)("p",null,"If you need a powerful resource with more vCPU, RAM or storage to host your production server, you can upgrade dynamically to a dedicated resource from your ",(0,o.kt)("a",{parentName:"p",href:"https://console.scaledyn.com/"},"ScaleDynamics Console"),". As shown below it's as simple as a few clicks."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Upgrade to dedicated",src:a(277).Z,width:"2610",height:"1504"})),(0,o.kt)("h2",{id:"whats-next"},"What\u2019s next"),(0,o.kt)("p",null,"At this stage, you have an awesome Drupal website published on cloud with Docker."),(0,o.kt)("p",null,"You can learn more on the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.scaledynamics.com/"},"ScaleDynamics documentation"),", like how to get the logs of your server, use a custom domain, implement a CI/CD pipeline, etc."),(0,o.kt)("p",null,"Enjoy!"))}d.isMDXComponent=!0},5681:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-admin-fb1198f4d7c97fd8f54f82fe866c72e9.png"},454:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-homepage-dea96d95c4b005c7a27b01f70c23f2ac.png"},2612:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-logo-b47dc4a950520a79501aab98143c791a.png"},4244:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-setup-1-eeacd2eb0ea6f1161a781d5999cf4421.png"},9218:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-setup-2-7b2d52fed1ee01cda4abea91d06c4f17.png"},6929:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-setup-3-7b909ae97acb6f4161a74f90d0f6b0a0.png"},6674:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/drupal-setup-4-c4cd9b9e4ac67ed574a2882d993bc2db.png"},5327:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/npx-deploy-4b61d1fce9b5ec4d74ed78bdba9d8bba.png"},3172:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-env-deploy-4a47be049c74e4b720e5b5815e6c1dcc.gif"},277:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/upgrade-resources-d681d9045259ce1378973bec8f4f0d1c.gif"}}]);